# 概述
## 背景
### 软件名称
KJ352煤矿安全监控系统。

###	通信能力
具备串口通信能力、CAN总线通信能力、TCP/IP通信能力。
### 用户体验
界面交互性好、易操作、容错能力强、使用方便灵活。
## 依据标准
- 《AQ6201-2006煤矿安全监控系统通用技术要求》；
- 《MT/T 1008-2006煤矿安全生产监控系统软件通用技术要求》
- 《煤矿安全监控系统升级改造技术方案（征求意见稿）》；
- 《煤矿安全规程（2016）》。
##   约束  

###　完成时间 

2017年5月底完成开发及测试工作。
### 源码
提供所有程序的相关源代码
### 文档
提供程序安装软件包，使用说明书及帮助文档。
## 用户特征
-	素质不高，多为中专学历
-	计算机操作水平一般，日常智能针对软件进行常规操作

# 2	功能需求
## 2.1	前提
必须具备“1.2依据标准”中所提到的所有功能及要求；
## 2.2	功能补充
### 2.1.1	数据采集
- 通过以太网采集设备的数据，设备采用主动上传数据的方式；
- 即时、快速、准确可靠；
- 不受软件其他操作的影响而中断，如查询、打印等操作；
### 2.1.2	控制
- 手动向一个或者多个设备同时发送不同内容的控制命令；
- 设定组合触发条件，当达到条件时自动向设备发送控制命令，设定条件的过程要简单，最好只用鼠标勾选一下即可完成；
- 记录发送控制命令的全过程以便进行实时查看及查询；
- 保证控制命令发送的即时、准确。
### 2.1.3	数据存储
- 保证数据源的唯一性或者多个数据源的一致性；
- 实时同步备份数据在不同盘区或者不同计算机等其他存储介质上；
- 设备信息变动频繁，且调用各种形式查看数据频繁；
- 数据文件适合方便拷贝、邮件传输等；
- 自定义存储时间，至少保证一年以上；
- 严禁用户修改数据。
### 2.1.4	数据查询
- 查询条件可以由一个或者多个组成；
- 查询结果必须准确；
### 2.1.5	显示
#### 2.1.5.1	列表
- 用户可自定义测点及测点属性；
- 可根据属性、关联性等信息将多个测点组合为一个列表，可以组合多个，然后平铺在同一个屏幕上；
- 报警、状态变动、故障等列表使用弹窗方式实时显示。
#### 2.1.5.2	曲线
- 曲线分为实时曲线、历史曲线和标校曲线。
- 容量8条，且同时显示模拟量曲线及开关量状态图；
- 可同时显示每条测点的实时监测、最大、最小、平均值曲线；
- 曲线坐标具有人工和智能自动调节功能；
- 曲线可以缩放，游标所到之处可以显示曲线的相关信息；
- 曲线可以随时进行显示及隐藏操作；
- 可以调用日、月、季、年曲线；
- 标校曲线在实时曲线和历史曲线上显示时要有明确标识。
#### 2.1.5.3	模拟动画显示
- 动画制作简单易上手；
- 测点添加、修改、删除等操作简便；
- 制作动画过程不影响软件其他功能的正常运行。
### 2.1.6	打印
- 所有功能都要具备打印功能；
- 根据标准要求打印各种类型的日报表、月报表；
- 自定义测点及测点属性；
- 自定义模板，使用时直接调用即可；
- 可人工打印和定时自动打印。
### 2.1.7	软件需要通过程序安装包的形式安装使用；
### 2.1.8	软件具有容错功能，不能因为用户的误操作、存储空间满等可预测的意外情况造成程序自动终止，从而影响软件的使用；
### 2.1.9	操作管理
- 不同人员设置不同级别的管理权限，操作前需要先登录；
- 可以记录、显示及查询用户的操作轨迹及操作内容。
### 2.1.10	主菜单
- 主菜单按照标准为统一的格式，在它的基础上可以增加其他菜单项；
### 2.1.11	数据定义
- 可根据设备类型等预定义缺省值；
- 界面易操作，关联性、实用性强；
- 对主机进行编辑测点等操作时，相关计算机（如备机）的内容也要随之自动修改，以保证数据定义的一致性。
### 2.1.12	报警功能
- 包括预报警、报警、断电、通讯故障、设备故障、试验报警等。
- 具备汉语语音报读，可自定义选择男女声音；
- 具备声音报警功能；
- 实时性强；
- 报警内容以弹窗方式显示，且同一个窗口可显示多条报警。
### 2.1.13	排序功能
### 2.1.14	自诊断
- 记录故障设备及故障类型、时间、范围等信息；
- 进行报警；
- 进行查询及打印。
### 2.1.15	双机切换
- 采用主、备机软切换方式；
- 以主机为主；
- 保证数据完整性或一致性。
### 2.1.16	数据接口
- 可以实时将数据根据某种协议配接到多个其他软件中；
- 不能影响本软件的运行；
### 2.1.17	快捷方式
- 采用右键属性选择方式，可以快捷方便的得到测点的相关信息，方便用户查看，以便提高软件的可操作性。
## 2.2	其他
# 3	性能需求
	按照windows界面的规范进行设计，包含菜单、工具栏、状态栏、滚动条、右键快捷菜单等标准格式。
	要求界面简洁，条理清晰，风格一致，布局和色彩搭配合理，操作简单。
	尽量使用鼠标选择，减少用户输入量。
## 3.1	界面
	软件的人机交互界面、显示、提示、打印、帮助等文字信息采用标准简体汉字。
## 3.2	登录页面
	软件启动时要有启动封面，封面上明确标注公司名称、公司标志、软件名称、版本号、版权声明等信息。
	软件关闭时要有退出页面，页面上写有感谢用语及售后服务电话号码等信息。
	封面要求图像清晰，大小为主流显示器分辨率的1/6大，且处于屏幕正中间。
## 3.3	框架
    简洁明快，整体色彩组合搭配合理，软件名称和图标放在显著位置，主菜单放在上边，工具栏放在菜单下边，状态栏放在下边，滚动条放右边。适用于多种分辨率，窗口缩放时，此窗口中包含的内容能随之缩放。
## 3.4	文字
	    输入的文字采用与界面风格匹配的字体，并能完成相关字体属性的设置，如输入上标和下标等。
    输入框的文字暂定不超过20个汉字或40个字符，需要时可以进行扩展。
## 3.5	按钮
具有简洁的图示效果，名称图示通俗易懂，风格统一。
	具有交互性，应至少有以下6种状态效果：
1.	点击前鼠标未放在上面的状态；
2.	点击前鼠标放在上面但未点击的状态；
3.	点击时状态；
4.	点击后鼠标未放在上面的状态；
5.	不能点击时状态；
6.	独立自动变化的状态；

常用按钮要支持键盘快捷方式。
默认按钮要支持Enter操作，即按Enter键后自动执行默认按钮对应操作。
## 3.6	面板
    各个功能区域划分明确，所有对话框、弹出框等都要具有最大、最小化和自定义缩放功能，风格一致，切换方便。
    支持多个窗口的平铺和罗列。
    具有特殊功能（如报警弹出框等）的弹出框的大小、位置、内容、显示颜色等属性由用户自定义，默认大小为主窗口的1/6。
## 3.7	菜单
    菜单具有选中和未选中两种状态，在任何显示模式下，主菜单均可选。

# 4	数据库设计
采用SQL Server数据库存储数据。
	数据库表格：
1.	模拟量测点属性表；
2.	开关量测点属性表；
3.	累计量测点属性表；
4.	模拟量实时数据表；
5.	开关量实时数据表；
6.	累计量实时数据表；
7.	模拟量历史数据表；
8.	开关量历史数据表；
9.	累计量历史数据表；
按照年月存储，存储内容包括完成的测点信息。
10.	统计数据表；
统计表格分多种时间段，由单独程序控制生成；
11.	模拟量报警数据表；
12.	开关量报警数据表；
13.	累计量报警数据表；
14.	模拟量故障表；
15.	开关量故障表；
16.	累计量故障表；
17.	状态变动表；
18.	标校数据表；
19.	人员操作表；
20.	安全管理表；
21.	补遗数据表；
22.	发送命令记录表；

#5	通讯方式 

	上位机采用UDP协议，与同接在以太环网上的CAN-E转换器建立连接以实现与现场设备的通讯。
    数据采集采用设备主动上传数据方式。

设备正常工作时，井下传感器主动上传数据给主机。

当主机在规定时间内接收不到某个设备的数据时，认定该设备通讯失败。
	补遗数据为井下具有存储数据功能的设备在接到主机发送的上传命令后将数据传送到主机，主机接收到这些数据后，只进行存储并不显示。


# 7	功能实现
## 7.1	数据采集
	采集的数据类型有模拟量、开关量、累计量和瓦斯抽采（放）量。
	模拟量包括：甲烷、风速、风压、一氧化碳、温度、电压、电流、功率、氧气、二氧化碳、水位、流量等。
    开关量包括：开停、馈电、风机、风筒、风门、断电器、烟雾等。
    累计量包括：产量等。
    瓦斯抽采（放）量包括：甲烷、温度、压力、混合流量、纯流量等。
## 7.2	数据处理
-	将采集到的数据进行协议解析；
-	换算数据；
-	解析数据状态；
-	将接收到的命令按照协议格式发送。
## 7.3	控制
	具有手动和自动两种控制方式：
-	手动控制：通过主机人机交互界面发送控制命令来控制现场设备。此方式一般用于实现地面中心站手动遥控现场设备的断电/复电功能和其他控制现场设备的功能。
手动控制交互界面可以通过菜单，右键快捷菜单、点击相关列表和画面调出，除菜单方式外，其他方式调出的手动控制交互界面要精确到需要控制的点。
-	自动控制：将执行序列和触发条件预先存储在系统中，当达到触发序列条件时主机自动向现场设备发送控制命令。此方式一般用于实现异地断电/复电功能。
序列的执行过程形成日志，供用户查看。
## 7.4	数据存储
	采用开放式数据库存储数据，数据值以工程单位值形式存储。
	存储内容：
1.	现场设备参数；
2.	实时监测值及时刻；
3.	统计值及时刻；
4.	报警/解除报警值及时刻；
5.	断电/复电值及时刻；
6.	馈电异常报警/解除异常报警时刻及状态；
7.	开关量状态及变动时刻；
8.	累计量值及时刻；
9.	瓦斯抽采（放）量及时刻；
10.	设备故障/解除故障状态及时刻；
11.	不通讯/通讯状态及时刻；
12.	操作记录及时刻；
13.	标校数据及时刻；
配置文件以文件形式存储，系统运行时自动生成，用户可删除。
## 7.5	显示
还应显示接收数据的时间，辅助功能查看通讯状态。
### 7.5.1	列表显示
    总体要求：
- 列表显示内容由用户选择；
- 表格、字体颜色由用户选择；
- 报警、断电、馈电异常报警等信息必须实时显示，并且相应的行和单元格颜色改变；
- 故障和通讯失败时，相应行和单元格颜色改变；
- 改变的颜色由用户自定义，默认为报警红色，故障兰色，通讯失败黄色；
- 通过选择行能直接访问到其相关联的，包括：属性定义、曲线、关联设备断电等；
- 表格具有列排序功能，且能根据地点、名称等属性进行模糊查询并显示；
- 所有测点可以在同一个表格中显示；
#### 7.5.1.1	模拟量数据表格显示
- 调用显示：
	根据所选的模拟量显示其相应内容：
1.	地点；
2.	名称；
3.	单位；
4.	报警门限；
5.	断电门限；
6.	复电门限；
7.	监测值；
8.	最近一次统计的最大值；
9.	最近一次统计的平均值；
10.	最后一次报警或解除报警时刻；
11.	最后一次断电或复电时刻；
12.	实时时钟；
- 报警显示：
	当模拟量大于或等于报警门限时，自动显示超限时刻等，显示内容：
1.	地点；
2.	名称；
3.	单位；
4.	报警门限；
5.	断电门限；
6.	复电门限；
7.	监测值；
8.	最后一次统计的最大值；
9.	最后一次统计的平均值；
10.	报警时刻；
11.	最后一次断电/复电时刻；
12.	断电区域；
13.	馈电状态及时刻；
14.	措施及采取措施时间；
15.	实时时钟；
-	断电显示：
	当模拟量大于或等于断电门限时，自动显示断电命令及时刻等，显示内容：
1.	地点；
2.	名称；
3.	单位；
4.	报警门限；
5.	断电门限；
6.	复电门限；
7.	监测值；
8.	报警及时刻；
9.	断电及时刻；
10.	断电区域；
11.	馈电状态及时刻；
12.	措施及采取措施时间；
13.	实时时钟；
-	馈电异常显示：
	当模拟量断电命令与馈电状态不一致时，自动显示馈电异常时刻，显示内容：
1.	地点；
2.	名称；
3.	单位；
4.	报警门限；
5.	断电门限；
6.	复电门限；
7.	监测值；
8.	报警及时刻；
9.	断电区域；
10.	馈电状态及时刻；
11.	措施及采取措施时间；
12.	实时时钟；
#### 7.5.1.2	开关量显示
-	调用显示  
	根据所选择的开关量选择其相关内容：
1.	地点；
2.	名称；
3.	报警及断电状态；
4.	设备状态及时刻；
5.	报警/断电及时刻；
6.	断电区域；
7.	馈电状态及时刻；
8.	措施及时刻；
-	报警与断电显示
	当开关量为报警与断电状态时，自动显示报警与断电时刻和状态等，显示内容：
1.	地点；
2.	名称；
3.	报警/断电状态；
4.	设备状态及时刻；
5.	断电/报警及时刻；
6.	断电区域；
7.	馈电状态及时刻；
8.	措施及时刻；
-	馈电异常显示
	当开关量断电命令与馈电状态不符时，自动显示馈电异常状态及时刻等，显示内容：
1.	地点；
2.	名称；
3.	报警/断电状态；
4.	设备状态及时刻；
5.	断电/报警及时刻；
6.	断电区域；
7.	馈电状态及时刻；
8.	措施及时刻；
-	状态变动显示
	当开关量状态发生变化时，显示当前状态变化的开关量的状态变动时刻和状态变动状况等，一般保持5min或10min。显示内容：
1.	地点；
2.	名称；
3.	报警及断电状态；
4.	设备状态及时刻；
5.	断电/报警及时刻；
6.	断电区域；
7.	馈电状态及时刻；
#### 7.5.1.3	累计量显示  
	显示内容：
1.	地点；
2.	名称；
3.	单位；
4.	班累计；
5.	日累计；
6.	月累计；
7.	年累计；
#### 7.5.1.4	瓦斯抽采（放.量显示
	显示内容：
1.	地点；
2.	名称；
3.	甲烷值和单位；
4.	温度值和单位；
5.	压力值和单位；
6.	班混合流量值和单位；
7.	班纯流量值和单位；
8.	日混合流量值和单位；
9.	日纯流量值和单位；
10.	月混合流量值和单位；
11.	月纯流量值和单位；
#### 7.5.2	模拟量曲线显示
	总体要求：
-	模拟量曲线以坐标曲线方式显示，坐标的竖轴为数值，横轴为时间。
-	竖轴的显示值为量程值和百分比值2种方式供用户选择，默认为量程值，量程值内容可以由用户自定义。同一坐标上多于1条曲线显示时若量程值不同则默认为百分比值显示。
-	横轴时间刻度划分由用户自定义，默认为4个时间刻度。
-	用平行于横轴的虚线显示报警、断电和复电门限（没有门限时可不用显示），虚线的种类和颜色由用户选择，默认报警门限为黄色，断电门限为红色，复电门限为蓝色。当多条门限值虚线重合时需要程序进行上下偏移处理显示，以达到同时显示3条门限的目的。
-	曲线上超过报警门限的部分不论曲线是什么颜色必须用红色显示。
-	曲线显示方式分锯齿波和方波2种供用户选择，默认为锯齿波。
-	曲线颜色由用户自定义。
-	在屏幕上方标明传感器的设置地点、所测物理量名称，起始、终止日期和时间，断电门限、复电门限、报警门限、断电范围、监测值、最大值、平均值、最小值等曲线的颜色等。以上为默认项，具体显示内容由用户自定义。
-	曲线上设置游标，游标所到之处应在游标旁边用透明窗口方式显示对应点的时刻、监测值、最大值、平均值、最小值、断电起止时刻及累计时间、报警起止时刻及累计时间、馈电异常起止时刻及累计时间、措施及采取措施时刻等信息，并能随游标的移动改变显示内容。多条曲线时显示内容按照曲线序号顺序排列，显示字体颜色为曲线颜色。若监测值超过报警门限则监测值颜色为红色。此项功能显示内容可以由用户自定义。
-	曲线窗口设置具有用户自定义时间量的左右平移，加大、减小和恢复取值时间，无极放大的按钮。
-	支持鼠标平移曲线取值时间，使用矩形框加大或减小曲线取值时间的功能。从左上向右下拖拽矩形框为减小取值时间，从右下向左上拖拽矩形框为加大取值时间。
-	绘制5日内曲线时间不能超过5秒钟，且绘制曲线期间不能影响主机正常工作。
-	曲线窗口设置打印、预览按钮。打印后的曲线横轴下方要根据用户选择显示说明文字，字体颜色同曲线颜色。
-	以输入查询起止时间为查询曲线基本方式。
-	同一坐标上默认可以显示8条模拟量曲线和开关量状态，特殊情况另行说明。
-	提供用户按照点号、安装地点、名称等信息过滤查找设备功能。
-	当模拟量曲线和开关量状态同时在一个坐标轴上显示时，开关量状态值显示的位置用户可以自定义（实际位置、竖轴的1/2处、竖轴的3/4处）。

	模拟量曲线显示包括：
1.	报警曲线
		列表显示查询起止时间段内的所有报警记录，供用户选择，同一个设备的记录列表上只显示1条。
		用户在列表上鼠标选择的顺序为曲线显示的序号。
2.	断电控制曲线
		列表显示查询起止时间段内的所有断电控制记录，供用户选择，同一个设备的记录列表上只显示1条。
		用户在列表上鼠标选择的顺序为曲线显示的序号。
3.	馈电异常曲线
		列表显示查询起止时间段内的所有馈电异常记录，供用户选择，同一个设备的记录列表上只显示1条。
		用户在列表上鼠标选择的顺序为曲线显示的序号。
4.	调用曲线
		用户从设备列表中选择需要显示的设备，输入查询起止时间。
5.	实时曲线
		用户从设备列表中选择需要显示的设备，设定刷新间隔。
6.	历史曲线
		用户从设备列表中选择需要显示的设备，输入查询起止时间。
7.	统计值曲线
		此曲线最多在一个坐标轴上显示一个设备的监测值、最大值、最小值和平均值曲线，显示曲线数量由用户自定义。
8.	标校曲线
		列表显示查询起止时间段内的所有标校记录，供用户选择，	同一个设备的记录列表上只显示1条。
		根据用户输入点号、安装地点和名称显示该设备最近8次标校记	录，供用户选择。


### 7.5.3	开关量状态图和柱状图显示
#### 7.5.3.1	开关量状态图显示
-	将开关量随时间变化的状态用直线显示。
-	在屏幕上方标明传感器的设置地点、所测物理量名称、起始和终止日期和时间、报警状态。
-	设置游标，游标所到之处应在游标旁边用透明窗口方式显示对应区间的起止时刻、报警及断电状态、馈电状态、措施及采取措施时刻等信息，并能随游标的移动改变显示内容。若是报警状态则报警及断电状态值颜色为红色，若为馈电异常则馈电状态值为红色。此项功能显示内容可以由用户自定义。
-	每个状态图窗口只显示一个设备的状态，最多能同时打开8个状态图窗口。
-	竖轴显示状态文字必须和设备定义内容值一致。

#### 7.5.3.2	开关量柱状图显示
-	将开关量单位时间内的开机效率（单位时间内开机时间）用直方图直观显示。
-	坐标竖轴为开机效率，横轴为时间；
-	在屏幕上方标明传感器设置地点、所测物理量名称、起始、终止日期和时间、报警状态。
-	设置游标，游标所到之处应在游标旁边用透明窗口方式显示对应区间的开机效率、开机时间、开停次数等，并能随游标的移动改变显示内容。
-	每个柱状图窗口只显示一个设备的柱状图，最多能同时打开8个柱状图窗口。
-	柱状图颜色由用户自定义。

#### 7.5.4	模拟图显示
	总体要求：
-	能导入CAD、JPEG等格式图片做背景图；
-	支持漫游、放大等功能；
-	配有图示图形基础图库，填入点号即可关联图示图形；
-	鼠标停留即可关联显示该点安装地点、名称、数值或状态等信息，显示内容由用户自定义；
-	定时切换画面且人工能停止；

	基本模拟图包括：
1. 通风系统模拟图
能够说明通风系统网络及设备配置的模拟图。
根据实时监测到的开关量状态、实时显示通风网络风流、设备工况（如主通风机、局部通风机、风门、风窗等.。
在相应位置实时数字显示甲烷、风速（或风量）、风压、一氧化碳、温度等。
2.	瓦斯抽采（放）系统模拟图
能够说明瓦斯抽放系统管路和设备配置的模拟图等。
根据实时监测到的开关量状态，实时显示相关设备工况（如抽放泵、阀门等）。
在相关位置实时数字显示甲烷浓度、温度、风压、流量等。
3.	监控系统自检模拟图
能够是说明监控系统设备（传输接口、分站、传感器等）布置和电缆敷设的模拟图形等。
根据系统自检情况，将具有故障的设备用不同颜色显示处理（如正常时为蓝色，故障时为红色）等。
4.	系统布置图
	显示传感器、分站、电源箱、断电控制器、传输接口和电缆等设备的设备名称、相应位置和运行状态等。
## 7.6	报警
	模拟量监测值超限（需要报警或断电）、馈电异常（断电命令与馈电状态不符）、开关量状态为报警状态，开关量状态发生改变、故障和通讯失败时发出报警信号，相关设备文字或图形闪烁，并伴随声响或语音提示。
### 7.6.1	报警内容
	设备的地点、名称、监测值、报警原因及时刻。
### 7.6.2	报警类别
1.	普通报警
	发生报警时系统采用声音和图标方式提示用户。
2.	强制报警
	发生报警时系统采用声音、图标和自动弹出报警窗口提示用户。
3.	状态变动报警
	开关量状态发生变动时，系统采用声音和图标方式提示用户，持续设定时间（默认5分钟）后所有状态没有改变则报警解除、声音和图标自动消失。
4.	故障和通讯失败报警
	传感器发生故障和通讯失败后，系统采用声音和图标方式提示用户。
5.	预报警
	在接近报警门限某一设定范围内进行的报警，系统采用声音和图标方式提示用户。
6.	双机切换报警
	当发生主备切换时，系统采用声音或语音和点亮图标方式提示用户。
7.	延时报警
	报警发生后不立即报警，延时一段时间后如还处于报警状态则进行报警，系统采用声音和图标方式提示用户。
8.	标校报警
	传感器标校时系统采用图标或声音加图标方式提示用户。
### 7.6.3	报警方式
#### 7.6.3.1	图标报警
报警时显示报警图标提示用户，用户通过双击图标可查看报警信息，查看后可最小化为图标，所有报警解除后图标自动消失。
#### 7.6.3.2	自动弹出窗口报警
强制性报警时自动弹出报警窗口提示用户，弹出窗口在所有窗口的最上层，报警期间用户只能移动该窗口不能关闭，直到所有报警解除后报警窗口消失。
#### 7.6.3.3	声音报警
声音报警采用播放声音文件和语音提示两种方式。
方式和内容由用户自定义，报警声音随报警的发生而发生，消失而消失。
用户点击后可关闭报警声音。
用户可以设置报警期间声音的播放方式：单次播放、循环播放。

-	声音文件：软件中提供用户录制声音文件的环境，相关文件链接选择。
-	语音提示：由于采用语音库，其中有些符号数字等读音不能满足用户需要，所以进行语音提示时需要对提示文字的读音进行语音置换。设置语音提示文字输入框，默认为用户已设定的提示内容，语音提示内容按照语音提示文字输入框中内容读出。
#### 7.6.3.4	光报警
当发生报警时，有关该设备的文字、数值、图符、曲线和模拟图形等用红色显示，或者红色显示加闪烁。
#### 7.6.3.5	手机报警
将报警数据发至手机上。
可设定5个发送级别，每个级别可设置10个手机号码。
手机报警可设置延时发送时间，延时后依然为报警状态的发送。
### 7.6.4	报警模式
单独报警：设备达到报警限后直接报警。
组合报警：几个设备同时达到报警限时才进行报警，例如：主备风机同时停后进行报警。
## 7.7	打印
	总体要求：
-	打印方式分为召唤和定时打印两种；
-	打印内容：报表、曲线、柱状图、状态图、模拟图、初始化参数等；
-	具有预览功能；
-	报表以excel表格方式显示，或可以导成excel格式；
-	单元格宽度默认为自动调整方式，即根据内容多少自动调整，用户也可自定义；
-	可以为每个打印内容预设页眉页脚等；
-	报表中每条数据增加“曲线”项，通过勾选连带打印其历史趋势曲线。
### 7.7.1	报表打印
#### 7.7.1.1	模拟量日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	传感器设置地址；
5.	所测物理量名称；
6.	单位；
7.	报警门限；
8.	断电门限；
9.	复电门限；
10.	平均值；
11.	最大值及时刻；
12.	报警次数；
13.	累计报警时间；
14.	断电次数；
15.	累计断电时间； 
16.	馈电异常次数；
17.	累计馈电异常时间；
7.7.1.2	模拟量报警日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	传感器设置地点；
5.	所测物理量名称；
6.	单位；
7.	报警门限；
8.	报警次数；
9.	累计报警时间；
10.	最大值及时刻；
11.	平均值；
12.	每次报警时刻及解除报警时刻；
13.	每次报警时间；
14.	每次报警期间平均值；
15.	每次报警期间最大值及时刻；
16.	每次措施和采取措施时刻；
#### 7.7.1.3	模拟量断电日（班.报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	传感器设置地点；
5.	所测物理量名称；
6.	单位；
7.	断电门限；
8.	复电门限；
9.	断电范围；
10.	断电次数；
11.	累计断电时间；
12.	最大值及时刻；
13.	平均值；
14.	每次断电累计时间；
15.	每次断电时刻及复电时刻；
16.	每次断电期间平均值；
17.	每次断电期间最大值及时刻；
18.	断电区域；
19.	馈电状态及时刻、累计时间；
20.	措施及采取措施时刻；
#### 7.7.1.4	模拟量馈电异常日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	地点；
5.	名称；
6.	断电区域；
7.	累计次数；
8.	累计断电时间；
9.	每次馈电状态累计时间及起止时刻；
10.	措施及采取措施时刻；
#### 7.7.1.5	开关量报警及断电日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	地点；
5.	名称；
6.	报警及断电；
7.	累计时间；
8.	累计次数；
9.	每次累计时间及起止时刻；
10.	断电区域；
11.	馈电状态及起止时刻、累计时间；
12.	措施及采取措施时刻；
#### 7.7.1.6	开关量馈电异常日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	地点；
5.	名称；
6.	断电区域；
7.	累计时间；
8.	累计次数；
9.	每次馈电状态；
10.	每次累计时间及起止时刻；
11.	措施及采取措施时刻；
#### 7.7.1.7	开关量状态变动日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	地点；
5.	名称；
6.	累计运行时间；
7.	累计变动次数；
8.	状态变动情况及时刻；
#### 7.7.1.8	监控设备故障日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	地点；
5.	名称；
6.	累计时间；
7.	累计次数；
8.	每次累计时间及起止时刻；
9.	措施及采取措施时刻；
10.	电缆故障位置；
#### 7.7.1.9	模拟量统计值历史记录查询报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	地点；
5.	名称；
6.	报警及断电；
7.	累计时间；
8.	累计次数；
9.	每次累计时间及起止时刻；
10.	断电区域；
11.	馈电状态及起止时刻、累计时间；
措施及采取措施时刻；
#### 7.7.1.10	累计量日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	地点；
5.	名称；
6.	单位；
7.	班累计量；
8.	日累计量；
#### 7.7.1.11	瓦斯抽放日（班）报表
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	甲烷平均值；
5.	温度平均值；
6.	压力平均值；
7.	班混合流量；
8.	班纯流量；
9.	日混合流量；
10.	日纯流量；
#### 7.7.1.12	月报表
### 7.7.2	曲线打印
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	曲线；
5.	安装地点；
6.	名称；
7.	单位；
### 7.7.3	状态图打印
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询起止时间；
4.	状态图；
5.	安装地点；
6.	名称；
7.	开停次数；
### 7.7.4	柱状图打印
	内容：
1.	表头；
2.	打印日期和时间；
3.	查询日期和时间；
4.	柱状图；
5.	安装地点；
6.	名称；
### 7.7.5	模拟图打印
	内容：
1.	表头；
2.	打印日期和时间；
3.	模拟图；
### 7.7.6	初始化参数打印
	内容：
1.	表头；
2.	打印日期和时间；
3.	安装地点；
4.	名称；
## 7.8	双机切换
-	系统具有双机自动和手动切换功能；
-	双机具有同步时间功能；
-	双机参数、数据等信息具有自动实时一致性；
-	双机满负载情况下切换时间不能大于3分钟；
-	双机切换时要有主备机图标变亮和声音提示；
## 7.9	数据备份
-	备份位置：在同一硬盘不同盘区或者其他计算机硬盘上；
-	备份方式：手动和自动；
-	备份内容：测点定义、实时和历史数据、报警数据等，如果条件允许可以备份整个数据库；
## 7.10	其他
### 7.10.1	网络通信功能
系统提供用于外接的数据接口，实现数据从本地传递到网络其它指定的位置。
传输方式有ftp、数据库远程登录等方式。
### 7.10.2	软件自监视功能
设置Atl＋M键为软件自监视功能键，操作该键切换到系统软件监视模式，列表显示软件中各任务运行状态。
### 7.10.3	软件容错功能
当发生键盘和鼠标操作、数据读写、外部设备未接或故障等错误时不能影响主机正常工作，显示提示窗口给用户，允许用户取消错误。这些
### 7.10.4	实时多任务功能
-	能实时传输、处理、存储和显示信息，并根据要求实时控制，能周期地循环运行而不中断；
-	系统正常运行，在进行连续打印、键盘操作等任务时不能影响数据等信息的处理、显示和存储；


# 8	软件功能
## 8.1	操作管理
对参数设置、控制等关键部分操作时需要用户通过用户名和密码登录后操作，并将用户的操作内容保存以备查询。
建立软件操作权限级别，分为三个等级：
普通等级：不需要登录软件系统，用户只能实现从系统软件中以各种表达方式读出数据功能。
高级等级：用户使用用户名和密码登录系统软件后，可以进行编辑测点、序列、设置属性、发送控制命令等。
管理等级：等级最高，登录系统软件后能实现所有系统软件功能，并负责配置用户，分配等级等信息。
## 8.2	主菜单
在各种显示模式下都必须有主菜单显示，主菜单包括：参数设置、页面编辑、控制、列表显示、曲线显示、状态图及柱状图显示、模拟图显示、打印、查询、帮助、其他等。
	在主菜单下必须设置子菜单：
1.	参数设置：系统参数、模拟量、开关量、累计量、其他；
2.	页面编辑：列表、曲线、模拟图、其他；
3.	控制：控制逻辑、操作、其他；
4.	列表显示：报警（模拟量、开关量）、断电控制（模拟量、开关量）、馈电异常（模拟量、开关量）、调用（模拟量、开关量）、设备故障、其他；
5.	曲线显示：报警、断电控制、馈电异常、调用、其他；
6.	状态图与柱状图显示：状态图、柱状图、其他；
7.	模拟图显示：通风系统、瓦斯抽采（放）、系统自检、其他；
8.	打印：编辑、报警（模拟量、开关量）、断电控制（模拟量、开关量）、馈电异常（模拟量、开关量）、调用（模拟量、开关量）、设备故障、其他；
9.	查询：报警（模拟量、开关量）、断电控制（模拟量、开关量）、馈电异常（模拟量、开关量）、调用（模拟量、开关量）、设备故障、其他；
10.	帮助：参数设置、页面编辑、控制、列表显示、曲线显示、状态图与柱状图显示、模拟图显示、打印、查询、其他；
## 8.3	分类查询
	具备以地点和名称为关键字的完全匹配查询和模糊查询两种方式。
1.	报警查询：根据输入的查询时间，将查询期间内的全部报警的模拟量和开关量显示或打印。
2.	断电查询：根据输入的查询时间，将查询期间内的全部断电的模拟量和开关量显示或打印。
3.	馈电异常查询：根据输入的查询时间，将查询期间内的全部馈电异常的开关量和模拟量显示或打印；
4.	调用查询：根据输入的被查询量和查询时间，将查询时间内被查询量显示或打印。
## 8.4	快捷方式
快捷方式采用键盘快捷键和鼠标右键菜单两种方式。
要求：在任何显示模拟下，均可直接进入所选监控量的列表显示、曲线显示或状态图及柱状图显示、模拟图显示、打印、参数设置、页面编辑、查询等方式。	
采用右键单击弹出快捷菜单方式时，能根据右键点击位置显示与该位置界面等相关联的菜单内容。
## 8.5	查询
## 8.6	用户帮助
提供详尽而可靠的帮助文档，帮助集成在软件中，通过菜单选择、F1帮助键、右键快捷菜单等方式调用，以方便用户随时寻求解决方法。
 
# 附件1：数据库设计
1.	测点属性表：  
- 模拟量

内容：点号、网号、中继器号、通道号、安装地点、名称、传感器类型、测点类型、量程下限、量程上限、单位、显示精度、报警模式、报警下限、报警上限、复电限、报警级别、报警延时、报警延时时间、故障报警、状态、记录死区、操作人、新建时间、删除时间；
- 开关量

内容：点号、网号、中继器号、通道号、安装地点、名称、传感器类型、测点类型、ON显示内容、OFF显示内容、报警模式、报警级别、报警延时、报警延时时间、状态变动、故障报警、状态、操作人、新建时间、删除时间；
- 累计量

内容：点号、网号、中继器号、通道号、安装地点、名称、传感器类型、测点类型、量程下限、量程上限、单位、显示精度、报警模式、报警下限、报警上限、报警级别、报警延时、报警延时时间、故障报警、状态、操作人、新建时间、删除时间；计算公式、
2. 历史数据表；
按照年月存储，存储内容包括完成的测点信息。
内容：点号、数值、状态、时间；
- 模拟量
- 开关量
- 累计量
3. 统计数据表；
统计表格分多种时间段，由单独程序控制生成；
4.	模拟量报警数据表；
5.	开关量报警数据表；
6.	累计量报警数据表；
7.	模拟量故障表；
8.	开关量故障表；
9.	累计量故障表；
10.	状态变动表；
11.	标校数据表；
12.	人员操作表；
13.	安全管理表；
14.	补遗数据表；
15.	发送命令记录表；
